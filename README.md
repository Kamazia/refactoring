# Рефакторинг. Начало.

## Предисловие

Из какого-то говно-кода, который проще полностью переписать чем что-то там исправлять, был выбран небольшой кусок на котором проводились эксперементы по лемке pretty candy

## Ход работы

1) **Замена исключения проверкой условия(Replace Exception with Test)**  
В первой главе этого не было, но тут очевидно что с этим нужно было что-то сделать, путем гуглинга и активации vpn ответ был найден на **refactoring.guru**  
   >*Исключения должны использоваться для обработки внештатного поведения, связанного с неожиданной ошибкой. Они не должны служить заменой проверкам выполнения условий. Если исключения можно избежать, просто проверив какое-то условие перед выполнением действия, то стоит так и сделать. Исключения следует приберечь для настоящих ошибок.*  

    Как раз тот случай, когда исключения были ожидаемыми и использовались вместо условий

2) **Объединение дублирующихся фрагментов в условных операторах (Consolidate Duplicate Conditional Fragments)**  
Открытие файла находилось во всех ветках условного оператора. Стоило вынести открытие чтение файла до условных операторов и в нужном месте вставить запись файла

3) **Извлечение метода (Extract Method)**  
Извлечение метода использовалось дважды.  
    1) Для предотвращения ошибок *json.decoder.JSONDecodeError* и *FileNotFoundError* был создан новый метод *check_user_data_file*, который проверяет это и вызывается при инициализации для атрибута пути  
    2) Для очистки полей *entry_login* и *entry_password* создан создан метод *__clear_fields*, который предотвращает дублирование кода

## Заключение

Ещё явно нужно что-то сделать с двумя большими условными операторами проверяющими *checkbox*, но не понял как лучше это сделать. Похоже конечно на то что описано в первой главе книги:  
   >*Для ввода схемы состояний я использую три операции рефакторинга. Сначала я перемещу поведение кода, зависящего от типа, в паттерн «Состояние» с помощью «Замены кода типа состоянием/стратегией» (ReplaceType Code with State / Strategy). Затем можно применить «Перемещение метода» ( Move Method), чтобыперенести оператор switch в класс Price. Наконец, с помощью «Замены условного оператораполиморфизмом» ( Replace Conditional with Polymorphism) я исключу оператор switch.*

   Но с другой стороны не так уж и похоже, потому что при разном состоянии (*checkbox*) выполняется разное действие.